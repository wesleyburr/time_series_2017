lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
print(theta[(np - 1):1])
print(v[1:(np - 1)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return(coe)
}
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
r <- 10
n <- matrix(rnorm(r*r),nrow = r)
ina(n)
r <- 10
n <- matrix(rnorm(r*r),nrow = r)
ina(n)$v
r <- 10
n <- matrix(rnorm(r*r),nrow = r)
ina(n)$v
r <- 10
n <- matrix(rnorm(r*r),nrow = r)
ina(n)$v
r <- 10
n <- matrix(rnorm(r*r),nrow = r)
ina(n)$v
r <- 10
n <- matrix(rnorm(r*r),nrow = r)
ina(n)$v
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
print(theta[(np - 1):1])
print(v)
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return(coe)
}
sgp(n,4)
sgp(n,4)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
#print(theta[(np - 1):1])
print(v)
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
#print(theta[(np - 1):1])
print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
#print(theta[(np - 1):1])
print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return()
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
#print(theta[(np - 1):1])
print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
#print(theta[(np - 1):1])
print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return()
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
#print(theta[(np - 1):1])
print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
print(theta[(np - 1):1])
#print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
coe <- c(coe, v[np])
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
ina <- function(k){
stopifnot(is.numeric(k))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
m <- length(k[1,])
stopifnot(m > 1)
v <- c(k[1,1])
theta <- matrix(0, nrow = m, ncol = m)
for (i in 1:(m - 1)) {  # theta_{i,*} and v_(i+1) in each step
theta[i,i + 1] <- 1/v[1] * k[i + 1, 1] # j=0
for (j in (i - 1):0) {
theta[i - j,i + 1] <- 1/v[j + 1] * (k[i + 1, j + 1] -
sum((theta[,(j + 1)])[j:1] * (theta[,(i + 1)])[i:(i - j + 1)] * v[1:j])
)
}
v_t <- k[i + 1, i + 1] - sum((theta[,(i + 1)])[i:1]^2 * v[1:i])
v <- c(v, v_t)   #v_i
}
return(
list("v" = v, "theta" = theta)
)
}
n <- matrix(c(0.125, 0.05,  0,     0,     0,
0.05,  0.125, 0.05,  0,     0,
0,     0.05,  0.125, 0.05,  0,
0,     0,     0.05,  0.125, 0.05,
0,     0,     0,     0.05,  0.125),
nrow = 5)
n
result <- ina(n)
result$v
resut
result
result$theta
result$v
result
r <- 10
n <- matrix(rnorm(r*r),nrow = r)
ina(n)$v
ina(n)$theta
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
n <- matrix(c(0.125, 0.05,  0,     0,     0,
0.05,  0.125, 0.05,  0,     0,
0,     0.05,  0.125, 0.05,  0,
0,     0,     0.05,  0.125, 0.05,
0,     0,     0,     0.05,  0.125),
nrow = 5)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
print(theta[(np - 1):1])
#print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
#
# *** here we might have negatice v and cause problems
#
coe <- c(coe, v[np]^(1/2))
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
n <- matrix(c(0.125, 0.05,  0,     0,     0,
0.05,  0.125, 0.05,  0,     0,
0,     0.05,  0.125, 0.05,  0,
0,     0,     0.05,  0.125, 0.05,
0,     0,     0,     0.05,  0.125),
nrow = 5)
sgp(n,4)
stop("wow")
stop("opps")
n <- 0
for (i in 1:10) {
n <- n+1
if (n > 100) {
stop("n>100")
}
}
n
for (i in 1:10) {
n <- n+i
if (n > 100) {
stop("n>100")
}
}
n
for (i in 1:100) {
n <- n+i
if (n > 100) {
stop("n>100")
}
}
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
print(v)
print(theta[(np - 1):1])
#print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
#
# *** here we might have negatice v and cause problems
#
coe <- c(coe, v[np]^(1/2))
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
n <- matrix(c(0.125, 0.05,  0,     0,     0,
0.05,  0.125, 0.05,  0,     0,
0,     0.05,  0.125, 0.05,  0,
0,     0,     0.05,  0.125, 0.05,
0,     0,     0,     0.05,  0.125),
nrow = 5)
sgp(n,4)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
print(v)
print(theta[(np - 1):1])
#print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
#
# *** here we might have negatice v and cause problems
#
coe <- c(coe, v[np]^(1/2))
return(coe)
}
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
print(v)
print(">>>>>>>>>>>>>>>>>")
print(theta[(np - 1):1])
#print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
#
# *** here we might have negatice v and cause problems
#
coe <- c(coe, v[np]^(1/2))
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
n <- matrix(c(0.125, 0.05,  0,     0,     0,
0.05,  0.125, 0.05,  0,     0,
0,     0.05,  0.125, 0.05,  0,
0,     0,     0.05,  0.125, 0.05,
0,     0,     0,     0.05,  0.125),
nrow = 5)
sgp(n,4)
n <- c(-1:10)
n
n>0
n>0 == TRUE
sum(n>0)
sum(n<0)
sum(n<=0)
n
print("n=", n)
print("n="n)
print("n=")
print(n)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
if (sum(n <= 0) > 0) {
print("v=")
print(v)
warning("negative v, see inovation algorithm")
}
print(theta[(np - 1):1])
#print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
#
# *** here we might have negatice v and cause problems
#
coe <- c(coe, v[np]^(1/2))
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
if (sum(n <= 0) > 0) {
print("v=")
print(v)
print(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>")
warning("negative v, see inovation algorithm")
}
print(theta[(np - 1):1])
#print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
#
# *** here we might have negatice v and cause problems
#
coe <- c(coe, v[np]^(1/2))
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
sgp <- function(k, np) {
stopifnot(is.numeric(k), is.numeric(np))
stopifnot(length(k[1,]) == length(k[,1]))
stopifnot(det(k) != 0)
stopifnot(np >= 2)
stopifnot(length(k[1,]) >= np + 1)
if(ceiling(np) != np) {
lag <- ceiling(np)
}
theta <- ina(k)$theta[,np]
v <- ina(k)$v
if (sum(n <= 0) > 0) {
print("v=")
print(v)
print(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>")
warning("negative v, see inovation algorithm")
}
#print(theta[(np - 1):1])
#print(v[1:(np)])
coe <- theta[(np - 1):1] * v[1:(np - 1)]^(1/2)
#
# *** here we might have negatice v and cause problems
#
coe <- c(coe, v[np]^(1/2))
return(coe)
}
r <- 10
k <- matrix(rnorm(r*r),nrow = r)
sgp(k, r-1)
?ina
